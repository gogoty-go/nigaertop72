<!DOCTYPE html>
<html>
<head>
    <title>CPU/RAM STRESS TEST</title>
    <meta charset="UTF-8">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            overflow: hidden;
            user-select: none;
        }
        
        body, html {
            width: 100%;
            height: 100%;
            background: #000;
            font-family: Arial, sans-serif;
            touch-action: none;
        }
        
        #statsPanel {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #0f0;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #0f0;
        }
        
        #warning {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: red;
            font-size: 48px;
            text-align: center;
            z-index: 200;
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: bold;
            pointer-events: none;
        }
        
        #startButton {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(to right, #ff5500, #ffaa00);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 28px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            z-index: 300;
            box-shadow: 0 0 30px rgba(255, 85, 0, 0.7);
        }
        
        .video-instance {
            position: absolute;
            opacity: 0.8;
            pointer-events: none;
            transform: scale(0.7);
            filter: hue-rotate(90deg);
            border: 2px solid white;
        }
        
        .particle {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 5;
        }
    </style>
</head>
<body>
    <div id="statsPanel">
        <div>CPU: <span id="cpuLoad">0%</span></div>
        <div>RAM: <span id="ramUsage">0 MB</span></div>
        <div>VIDEOS: <span id="videoCount">0</span></div>
        <div>PARTICLES: <span id="particleCount">0</span></div>
    </div>
    <div id="warning">CPU OVERLOAD</div>
    <button id="startButton">START CPU STRESS TEST</button>

    <script>
        // Конфигурация нагрузки
        const VIDEO_INSTANCES = 300; // Количество видео
        const MAX_PARTICLES = 500000; // 500 тысяч частиц
        const MEMORY_BLOCKS = 1000; // Количество блоков памяти
        const PHYSICS_STEPS = 20; // Шагов физики за кадр
        const WORKER_COUNT = 8; // Количество веб-воркеров
        
        // Глобальные переменные
        let particles = [];
        let memoryBlocks = [];
        let workers = [];
        let videoElements = [];
        let cpuUsage = 0;
        let ramUsage = 0;
        let testStarted = false;
        
        // Инициализация теста
        document.getElementById('startButton').addEventListener('click', function() {
            if (testStarted) return;
            
            testStarted = true;
            this.style.display = 'none';
            
            // Создание видео-копий
            createVideoInstances();
            
            // Создание частиц
            createParticles();
            
            // Запуск воркеров
            startWorkers();
            
            // Заполнение памяти
            allocateMemory();
            
            // Запуск физики
            setInterval(updatePhysics, 0);
            
            // Запуск основного цикла
            requestAnimationFrame(update);
            
            // Запуск мониторинга
            setInterval(updateStats, 500);
        });
        
        // Создание множества видео-копий
        function createVideoInstances() {
            const container = document.body;
            
            for (let i = 0; i < VIDEO_INSTANCES; i++) {
                const video = document.createElement('video');
                video.className = 'video-instance';
                video.autoplay = true;
                video.loop = true;
                video.muted = true;
                video.playsInline = true;
                video.src = 'Olaf.mp4';
                
                // Случайная позиция и размер
                video.style.left = Math.random() * 100 + 'vw';
                video.style.top = Math.random() * 100 + 'vh';
                video.style.width = (15 + Math.random() * 30) + 'vw';
                
                // Случайные трансформации
                video.style.transform = `
                    scale(${0.4 + Math.random() * 0.6})
                    rotate(${Math.random() * 360}deg)
                `;
                
                // Фильтры
                video.style.filter = `
                    hue-rotate(${Math.random() * 360}deg)
                    contrast(${100 + Math.random() * 200}%)
                `;
                
                container.appendChild(video);
                videoElements.push(video);
                
                try {
                    video.play();
                } catch(e) {
                    console.error("Video play failed:", e);
                }
            }
            
            document.getElementById('videoCount').textContent = VIDEO_INSTANCES;
        }
        
        // Создание частиц для нагрузки на CPU
        function createParticles() {
            particles = [];
            for (let i = 0; i < MAX_PARTICLES; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                // Случайные свойства
                particle.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                particle.style.boxShadow = `0 0 ${Math.random() * 10 + 2}px currentColor`;
                
                // Начальная позиция
                particle.style.left = `${Math.random() * 100}vw`;
                particle.style.top = `${Math.random() * 100}vh`;
                
                document.body.appendChild(particle);
                
                // Сохранить для физики
                particles.push({
                    element: particle,
                    x: Math.random() * window.innerWidth,
                    y: Math.random() * window.innerHeight,
                    vx: (Math.random() - 0.5) * 4,
                    vy: (Math.random() - 0.5) * 4,
                    size: parseFloat(particle.style.width),
                });
            }
            
            document.getElementById('particleCount').textContent = MAX_PARTICLES;
        }
        
        // Запуск веб-воркеров для нагрузки на CPU
        function startWorkers() {
            const workerCode = `
                self.onmessage = function() {
                    // Интенсивные вычисления
                    while(true) {
                        // Математические операции
                        let sum = 0;
                        for (let i = 0; i < 10000000; i++) {
                            sum += Math.sin(i) * Math.cos(i);
                        }
                        
                        // Работа с большими массивами
                        const bigArray = new Array(500000);
                        for (let i = 0; i < 500000; i++) {
                            bigArray[i] = Math.random();
                        }
                        
                        // Сортировка
                        bigArray.sort();
                        
                        // Криптографические операции
                        let hash = 0;
                        for (let i = 0; i < bigArray.length; i++) {
                            hash = ((hash << 5) - hash) + bigArray[i];
                            hash |= 0;
                        }
                        
                        // Отправка результата
                        postMessage(hash);
                    }
                };
            `;
            
            const blob = new Blob([workerCode], {type: 'application/javascript'});
            const workerURL = URL.createObjectURL(blob);
            
            for (let i = 0; i < WORKER_COUNT; i++) {
                const worker = new Worker(workerURL);
                worker.postMessage('start');
                workers.push(worker);
            }
        }
        
        // Заполнение оперативной памяти
        function allocateMemory() {
            // Создание больших массивов
            for (let i = 0; i < MEMORY_BLOCKS; i++) {
                // Каждый блок ~2MB
                const block = new Float64Array(262144); 
                
                // Заполнение данных
                for (let j = 0; j < block.length; j++) {
                    block[j] = Math.random();
                }
                
                memoryBlocks.push(block);
            }
        }
        
        // Интенсивное обновление физики
        function updatePhysics() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            
            // Многократное обновление для увеличения нагрузки
            for (let step = 0; step < PHYSICS_STEPS; step++) {
                for (let i = 0; i < particles.length; i++) {
                    const p = particles[i];
                    
                    // Физические расчеты
                    p.vx += (Math.random() - 0.5) * 0.1;
                    p.vy += (Math.random() - 0.5) * 0.1 + 0.05; // Гравитация
                    
                    p.x += p.vx;
                    p.y += p.vy;
                    
                    // Отскоки от границ
                    if (p.x < 0 || p.x > width) p.vx *= -0.8;
                    if (p.y < 0 || p.y > height) p.vy *= -0.8;
                    
                    // Ограничение координат
                    p.x = Math.max(0, Math.min(width, p.x));
                    p.y = Math.max(0, Math.min(height, p.y));
                    
                    // Обновление позиции
                    p.element.style.left = `${p.x}px`;
                    p.element.style.top = `${p.y}px`;
                }
                
                // Дополнительная нагрузка: обновление видео
                for (let i = 0; i < videoElements.length; i++) {
                    if (i % 50 === 0) {
                        const video = videoElements[i];
                        video.style.transform = `
                            scale(${0.5 + Math.random() * 0.5})
                            rotate(${Math.random() * 360}deg)
                        `;
                        video.style.filter = `
                            hue-rotate(${Math.random() * 360}deg)
                            contrast(${100 + Math.random() * 200}%)
                        `;
                    }
                }
            }
        }
        
        // Основной цикл обновления
        function update() {
            // Простая анимация без GPU нагрузки
            for (let i = 0; i < particles.length; i += 1000) {
                const p = particles[i];
                p.element.style.backgroundColor = `hsl(${(Date.now() / 10 + i) % 360}, 100%, 50%)`;
            }
            
            requestAnimationFrame(update);
        }
        
        // Обновление статистики
        function updateStats() {
            // Расчет использования CPU (условный)
            cpuUsage = Math.min(100, cpuUsage + 1 + Math.random() * 4);
            
            // Расчет использования RAM
            ramUsage = Math.floor(performance.memory.usedJSHeapSize / (1024 * 1024));
            
            // Обновление панели
            document.getElementById('cpuLoad').textContent = `${Math.round(cpuUsage)}%`;
            document.getElementById('ramUsage').textContent = `${ramUsage} MB`;
            
            // Показ предупреждения при высокой нагрузке
            if (cpuUsage > 90) {
                document.getElementById('warning').style.opacity = '1';
                document.getElementById('warning').textContent = `CPU OVERLOAD: ${Math.round(cpuUsage)}%`;
            } else {
                document.getElementById('warning').style.opacity = '0';
            }
            
            // Автоматическое увеличение нагрузки
            if (testStarted && cpuUsage < 95) {
                cpuUsage += 0.5;
            }
        }
        
        // Блокировка защитных функций
        window.addEventListener('keydown', (e) => {
            if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
                e.preventDefault();
                // Увеличение нагрузки при попытке открыть DevTools
                cpuUsage = Math.min(100, cpuUsage + 15);
            }
        });
        
        window.onbeforeunload = (e) => {
            e.preventDefault();
            e.returnValue = '';
            return "Тест процессора в процессе! Прерывание может вызвать нестабильность системы.";
        };
    </script>
</body>
</html>
