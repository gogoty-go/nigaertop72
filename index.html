<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–π –ú–∏—Ä: –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            overflow: hidden;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #e6e6e6;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        header {
            background: rgba(10, 15, 30, 0.85);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #4cc9f0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(45deg, #4cc9f0, #4361ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 10px rgba(76, 201, 240, 0.3);
        }
        
        .player-stats {
            display: flex;
            gap: 25px;
        }
        
        .stat {
            background: rgba(25, 35, 65, 0.7);
            padding: 8px 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid #4361ee;
        }
        
        .stat-icon {
            font-size: 1.2rem;
            color: #4cc9f0;
        }
        
        .game-container {
            flex: 1;
            display: flex;
            position: relative;
        }
        
        #gameCanvas {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
        
        .ui-overlay {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            z-index: 5;
        }
        
        .controls {
            background: rgba(10, 15, 30, 0.85);
            padding: 15px;
            border-radius: 15px;
            width: 300px;
            border: 1px solid #4361ee;
            box-shadow: 0 0 20px rgba(67, 97, 238, 0.3);
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group h3 {
            margin-bottom: 10px;
            color: #4cc9f0;
            font-size: 1.1rem;
        }
        
        .btn {
            background: linear-gradient(45deg, #4361ee, #3a0ca3);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 8px;
            margin-bottom: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(67, 97, 238, 0.5);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .quest-panel {
            background: rgba(10, 15, 30, 0.9);
            padding: 20px;
            border-radius: 15px;
            width: 350px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #f72585;
            box-shadow: 0 0 20px rgba(247, 37, 133, 0.3);
        }
        
        .quest-title {
            color: #f72585;
            margin-bottom: 15px;
            font-size: 1.3rem;
            border-bottom: 1px solid #f72585;
            padding-bottom: 8px;
        }
        
        .quest-description {
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .choice-btn {
            background: rgba(67, 97, 238, 0.2);
            border: 1px solid #4361ee;
            color: #e6e6e6;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s ease;
        }
        
        .choice-btn:hover {
            background: rgba(67, 97, 238, 0.4);
            transform: translateX(5px);
        }
        
        .world-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(10, 15, 30, 0.85);
            padding: 15px;
            border-radius: 15px;
            width: 250px;
            border: 1px solid #7209b7;
            box-shadow: 0 0 20px rgba(114, 9, 183, 0.3);
        }
        
        .world-title {
            color: #7209b7;
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.2rem;
        }
        
        .world-features {
            list-style-type: none;
        }
        
        .world-features li {
            padding: 8px 0;
            border-bottom: 1px dashed #3a0ca3;
            display: flex;
            align-items: center;
        }
        
        .world-features li:before {
            content: "‚Ä¢";
            color: #4cc9f0;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f3460, #1a1a2e);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            transition: opacity 1s ease;
        }
        
        .loading-title {
            font-size: 2.5rem;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #4cc9f0, #f72585);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .progress-container {
            width: 60%;
            max-width: 500px;
            height: 20px;
            background: rgba(25, 35, 65, 0.7);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #4361ee;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4361ee, #3a0ca3, #f72585);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .loading-text {
            margin-top: 20px;
            font-size: 1.2rem;
            color: #4cc9f0;
        }
        
        .tip {
            position: absolute;
            bottom: 20%;
            font-style: italic;
            color: rgba(255, 255, 255, 0.6);
            text-align: center;
            width: 80%;
        }
        
        .mini-map {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 150px;
            height: 150px;
            background: rgba(10, 15, 30, 0.7);
            border: 2px solid #4cc9f0;
            border-radius: 10px;
            z-index: 5;
            overflow: hidden;
        }
        
        .player-marker {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #f72585;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 10px #f72585;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">–ü—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–π –ú–∏—Ä: –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ</div>
        <div class="player-stats">
            <div class="stat">
                <span class="stat-icon">‚ù§Ô∏è</span>
                <span id="health">100</span>
            </div>
            <div class="stat">
                <span class="stat-icon">‚ö°</span>
                <span id="energy">80</span>
            </div>
            <div class="stat">
                <span class="stat-icon">üíé</span>
                <span id="coins">50</span>
            </div>
            <div class="stat">
                <span class="stat-icon">üèÜ</span>
                <span id="level">1</span>
            </div>
        </div>
    </header>
    
    <div class="game-container">
        <div class="loading-screen" id="loadingScreen">
            <h1 class="loading-title">–ì–ï–ù–ï–†–ê–¶–ò–Ø –í–ê–®–ï–ì–û –ú–ò–†–ê</h1>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="loading-text" id="loadingText">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–¥—Ä–∞ –º–∏—Ä–∞...</div>
            <div class="tip" id="tip">–ö–∞–∂–¥—ã–π –º–∏—Ä —É–Ω–∏–∫–∞–ª–µ–Ω –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –≤–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è</div>
        </div>
        
        <div class="mini-map" id="miniMap">
            <div class="player-marker" id="playerMarker"></div>
        </div>
        
        <div class="world-info">
            <div class="world-title" id="worldName">–ù–∞–∑–≤–∞–Ω–∏–µ –º–∏—Ä–∞</div>
            <ul class="world-features" id="worldFeatures">
                <li>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∞–Ω–¥—à–∞—Ñ—Ç–∞...</li>
            </ul>
        </div>
        
        <canvas id="gameCanvas"></canvas>
        
        <div class="ui-overlay">
            <div class="controls">
                <div class="control-group">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
                    <button class="btn">W: –í–ø–µ—Ä–µ–¥</button>
                    <button class="btn">S: –ù–∞–∑–∞–¥</button>
                    <button class="btn">A: –í–ª–µ–≤–æ</button>
                    <button class="btn">D: –í–ø—Ä–∞–≤–æ</button>
                    <button class="btn">–ü—Ä–æ–±–µ–ª: –ü—Ä—ã–∂–æ–∫</button>
                    <button class="btn">Shift: –ë–µ–≥</button>
                </div>
                <div class="control-group">
                    <h3>–î–µ–π—Å—Ç–≤–∏—è</h3>
                    <button class="btn" id="interactBtn">E: –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å</button>
                    <button class="btn" id="inventoryBtn">I: –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
                    <button class="btn" id="mapBtn">M: –ö–∞—Ä—Ç–∞</button>
                </div>
            </div>
            
            <div class="quest-panel">
                <div class="quest-title" id="questTitle">–¢–µ–∫—É—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ</div>
                <div class="quest-description" id="questDescription">–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å—é–∂–µ—Ç –¥–ª—è –≤–∞—Å...</div>
                <div class="choices" id="choicesContainer">
                    <!-- Choices will be added dynamically -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        const loadingScreen = document.getElementById('loadingScreen');
        const progressBar = document.getElementById('progressBar');
        const loadingText = document.getElementById('loadingText');
        const tip = document.getElementById('tip');
        const worldName = document.getElementById('worldName');
        const worldFeatures = document.getElementById('worldFeatures');
        const questTitle = document.getElementById('questTitle');
        const questDescription = document.getElementById('questDescription');
        const choicesContainer = document.getElementById('choicesContainer');
        const healthEl = document.getElementById('health');
        const energyEl = document.getElementById('energy');
        const coinsEl = document.getElementById('coins');
        const levelEl = document.getElementById('level');
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let playerName = "–ò—Å–∫–∞—Ç–µ–ª—å";
        let playerTraits = {
            courage: 5,
            wisdom: 5,
            compassion: 5
        };
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ –º–∏—Ä–∞
        const worldPrefixes = ["–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ", "–ó–∞–±—ã—Ç—ã–µ", "–î—Ä–µ–≤–Ω–∏–µ", "–í–µ—á–Ω—ã–µ", "–ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ"];
        const worldSuffixes = ["–ó–µ–º–ª–∏", "–ü—É—Å—Ç–æ—à–∏", "–õ–µ—Å–∞", "–ì–æ—Ä—ã", "–î–æ–ª–∏–Ω—ã", "–û—Å—Ç—Ä–æ–≤–∞"];
        const worldNames = ["–≠–ª–¥–æ—Ä–∏—è", "–ê—Å—Ç—Ä–∞–ª–∏—è", "–ù–µ–∫—Å—É—Å", "–ó–µ—Ñ–∏—Ä–∏—è", "–ö—Å–∞–Ω–∞–¥—É", "–ê—Ä–∫–∞–Ω–∏—è"];
        
        // –¢–∏–ø—ã –±–∏–æ–º–æ–≤
        const biomes = [
            { name: "–õ–µ—Å", color: 0x4caf50, features: ["–î–µ—Ä–µ–≤—å—è", "–†—É—á–µ–π", "–ü–æ–ª—è–Ω–∞"] },
            { name: "–ì–æ—Ä—ã", color: 0x9e9e9e, features: ["–°–∫–∞–ª—ã", "–ü–µ—â–µ—Ä—ã", "–û–±—Ä—ã–≤"] },
            { name: "–ü—É—Å—Ç—ã–Ω—è", color: 0xffeb3b, features: ["–î—é–Ω—ã", "–û–∞–∑–∏—Å", "–ö–∞–∫—Ç—É—Å—ã"] },
            { name: "–¢—É–Ω–¥—Ä–∞", color: 0xbbdefb, features: ["–°–Ω–µ–≥", "–õ–µ–¥", "–•–æ–ª–º—ã"] },
            { name: "–ë–æ–ª–æ—Ç–æ", color: 0x795548, features: ["–¢—Ä—è—Å–∏–Ω–∞", "–ì—Ä–∏–±—ã", "–¢—É–º–∞–Ω"] }
        ];
        
        // –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–≤–µ—Ç—ã
        const tips = [
            "–í–∞—à–∏ —Ä–µ—à–µ–Ω–∏—è –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ —Å—é–∂–µ—Ç–∞ –∏ –æ–∫—Ä—É–∂–∞—é—â–∏–π –º–∏—Ä",
            "–ò—Å—Å–ª–µ–¥—É–π—Ç–µ –∫–∞–∂–¥—É—é –ª–æ–∫–∞—Ü–∏—é - –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã",
            "–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–π—Ç–µ —Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è",
            "–¢–µ–º–Ω–æ–µ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø–∞—Å–Ω—ã–º - –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã",
            "–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–±–ª–∞—Å—Ç–∏ –º–∏—Ä–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π"
        ];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Three.js
        let scene, camera, renderer, controls;
        
        // –ò–≥—Ä–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã
        let terrain, player, objects = [];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ –∏–≥—Ä–æ–∫–∞
            playerName = generatePlayerName();
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏—Ä–∞
            const generatedWorldName = generateWorldName();
            worldName.textContent = generatedWorldName;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∏
            simulateLoading();
        }
        
        // –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
        function simulateLoading() {
            let progress = 0;
            const steps = [
                "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–¥—Ä–∞ –º–∏—Ä–∞...",
                "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∞–Ω–¥—à–∞—Ñ—Ç–∞...",
                "–°–æ–∑–¥–∞–Ω–∏–µ –±–∏–æ–º–æ–≤...",
                "–†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤...",
                "–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—é–∂–µ—Ç–∞...",
                "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π...",
                "–°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π..."
            ];
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                
                progressBar.style.width = `${progress}%`;
                
                if (progress < 25) {
                    loadingText.textContent = steps[0];
                } else if (progress < 40) {
                    loadingText.textContent = steps[1];
                } else if (progress < 55) {
                    loadingText.textContent = steps[2];
                } else if (progress < 70) {
                    loadingText.textContent = steps[3];
                } else if (progress < 85) {
                    loadingText.textContent = steps[4];
                } else {
                    loadingText.textContent = steps[5];
                }
                
                // –°–ª—É—á–∞–π–Ω—ã–π —Å–æ–≤–µ—Ç
                if (Math.random() > 0.7) {
                    tip.textContent = tips[Math.floor(Math.random() * tips.length)];
                }
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        loadingScreen.style.opacity = "0";
                        setTimeout(() => {
                            loadingScreen.style.display = "none";
                            initThreeJS();
                            generateWorldFeatures();
                            generateInitialQuest();
                        }, 1000);
                    }, 500);
                }
            }, 300);
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ –∏–≥—Ä–æ–∫–∞
        function generatePlayerName() {
            const prefixes = ["–°–º–µ–ª—ã–π", "–ú—É–¥—Ä—ã–π", "–û—Ç–≤–∞–∂–Ω—ã–π", "–•–∏—Ç—Ä—ã–π", "–ë–ª–∞–≥–æ—Ä–æ–¥–Ω—ã–π"];
            const names = ["–ê—Ä–∞–≥–æ—Ä–Ω", "–ì–µ–Ω–¥–∞–ª—å—Ñ", "–õ–µ–≥–æ–ª–∞—Å", "–ì–∏–º–ª–∏", "–§—Ä–æ–¥–æ", "–ì–∞–ª–∞–¥—Ä–∏—ç–ª—å"];
            return `${prefixes[Math.floor(Math.random() * prefixes.length)]} ${names[Math.floor(Math.random() * names.length)]}`;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –º–∏—Ä–∞
        function generateWorldName() {
            const prefix = worldPrefixes[Math.floor(Math.random() * worldPrefixes.length)];
            const suffix = worldSuffixes[Math.floor(Math.random() * worldSuffixes.length)];
            const name = worldNames[Math.floor(Math.random() * worldNames.length)];
            return `${prefix} ${suffix} ${name}`;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –º–∏—Ä–∞
        function generateWorldFeatures() {
            worldFeatures.innerHTML = "";
            
            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π
            const featureCount = 4 + Math.floor(Math.random() * 3);
            
            // –°–ª—É—á–∞–π–Ω—ã–µ –±–∏–æ–º—ã
            const selectedBiomes = [];
            while (selectedBiomes.length < 3) {
                const biome = biomes[Math.floor(Math.random() * biomes.length)];
                if (!selectedBiomes.includes(biome)) {
                    selectedBiomes.push(biome);
                    
                    const li = document.createElement("li");
                    li.textContent = `${biome.name}: ${biome.features[Math.floor(Math.random() * biome.features.length)]}`;
                    worldFeatures.appendChild(li);
                }
            }
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
            const specialFeatures = [
                "–ü–ª–∞–≤–∞—é—â–∏–µ –æ—Å—Ç—Ä–æ–≤–∞",
                "–ö—Ä–∏—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—â–µ—Ä—ã",
                "–î—Ä–µ–≤–Ω–∏–µ —Ä—É–∏–Ω—ã",
                "–ó–∞—á–∞—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–µ—Å",
                "–í—É–ª–∫–∞–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è",
                "–ü–æ–¥–∑–µ–º–Ω—ã–µ –≥–æ—Ä–æ–¥–∞"
            ];
            
            for (let i = 0; i < featureCount - 3; i++) {
                const feature = specialFeatures[Math.floor(Math.random() * specialFeatures.length)];
                const li = document.createElement("li");
                li.textContent = feature;
                worldFeatures.appendChild(li);
            }
            
            // –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å
            const uniqueFeatures = [
                "–ü–æ—Ä—Ç–∞–ª –≤ –¥—Ä—É–≥–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ",
                "–î—Ä–µ–≤–æ –∂–∏–∑–Ω–∏",
                "–ì–æ—Ä–æ–¥ –≤ –Ω–µ–±–µ",
                "–û–∑–µ—Ä–æ –≤—Ä–µ–º–µ–Ω–∏",
                "–ú–∞–≥–∏—á–µ—Å–∫–∏–π –≤–æ–¥–æ–ø–∞–¥"
            ];
            const li = document.createElement("li");
            li.innerHTML = `<strong>–£–Ω–∏–∫–∞–ª—å–Ω–æ: ${uniqueFeatures[Math.floor(Math.random() * uniqueFeatures.length)]}</strong>`;
            worldFeatures.appendChild(li);
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
        function generateInitialQuest() {
            const questTypes = [
                {
                    title: "–ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ —Ä–µ–ª–∏–∫–≤–∏–∏",
                    description: "–°—Ç–∞—Ä–µ–π—à–∏–Ω–∞ –¥–µ—Ä–µ–≤–Ω–∏ –ø—Ä–æ—Å–∏—Ç –≤–∞—Å –Ω–∞–π—Ç–∏ –¥—Ä–µ–≤–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã, —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–Ω—ã–µ –ø–æ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç—è–º. –ë–µ–∑ –Ω–∏—Ö –¥–µ—Ä–µ–≤–Ω—è –Ω–µ —Å–º–æ–∂–µ—Ç –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç –Ω–∞–¥–≤–∏–≥–∞—é—â–µ–π—Å—è —É–≥—Ä–æ–∑—ã.",
                    choices: [
                        "–°–æ–≥–ª–∞—Å–∏—Ç—å—Å—è –ø–æ–º–æ—á—å –¥–µ—Ä–µ–≤–Ω–µ",
                        "–ü–æ–ø—Ä–æ—Å–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É –≤–ø–µ—Ä–µ–¥",
                        "–û—Ç–∫–∞–∑–∞—Ç—å—Å—è, —Å–∫–∞–∑–∞–≤ —á—Ç–æ —É –≤–∞—Å —Å–≤–æ–∏ –¥–µ–ª–∞"
                    ]
                },
                {
                    title: "–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ",
                    description: "–ñ–∏—Ç–µ–ª–∏ –æ–±–µ—Å–ø–æ–∫–æ–µ–Ω—ã –ø—Ä–æ–ø–∞–∂–µ–π –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–µ–ª–æ–≤–µ–∫ –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç—è—Ö —Ç–µ–º–Ω–æ–≥–æ –ª–µ—Å–∞. –ú–µ—Å—Ç–Ω—ã–π –æ—Ö–æ—Ç–Ω–∏–∫ –≤–∏–¥–µ–ª —Å—Ç—Ä–∞–Ω–Ω—ã–µ –æ–≥–Ω–∏ –≤ –Ω–æ—á–∏ –∏ —Å–ª—ã—à–∞–ª –∂—É—Ç–∫–∏–µ –∑–≤—É–∫–∏.",
                    choices: [
                        "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Ç–µ–º–Ω—ã–π –ª–µ—Å",
                        "–†–∞—Å—Å–ø—Ä–æ—Å–∏—Ç—å –∂–∏—Ç–µ–ª–µ–π –ø–æ–¥—Ä–æ–±–Ω–µ–µ",
                        "–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–∞–Ω—è—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏—â–µ–µ–∫"
                    ]
                },
                {
                    title: "–ù–∞—Ä—É—à–µ–Ω–Ω—ã–π –±–∞–ª–∞–Ω—Å",
                    description: "–ü—Ä–∏—Ä–æ–¥–∞ –≤–æ–∫—Ä—É–≥ –≤–µ–¥–µ—Ç —Å–µ–±—è —Å—Ç—Ä–∞–Ω–Ω–æ - —Ä–µ–∫–∏ –º–µ–Ω—è—é—Ç —Ç–µ—á–µ–Ω–∏–µ, —Ä–∞—Å—Ç–µ–Ω–∏—è —Ä–∞—Å—Ç—É—Ç –Ω–µ –ø–æ —Å–µ–∑–æ–Ω—É. –î—Ä—É–∏–¥ –ø—Ä–æ—Å–∏—Ç –≤–∞—Å –Ω–∞–π—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞.",
                    choices: [
                        "–ü–æ–º–æ—á—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å",
                        "–ü–æ–ø—Ä–æ—Å–∏—Ç—å –º–∞–≥–∏—á–µ—Å–∫–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –¥–ª—è –ø–æ–º–æ—â–∏",
                        "–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥—Ä—É–∏–¥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å–∞–º–æ–º—É"
                    ]
                }
            ];
            
            const quest = questTypes[Math.floor(Math.random() * questTypes.length)];
            
            questTitle.textContent = quest.title;
            questDescription.textContent = quest.description;
            
            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤—ã–±–æ—Ä–æ–≤
            choicesContainer.innerHTML = "";
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –≤—ã–±–æ—Ä–æ–≤
            quest.choices.forEach((choice, index) => {
                const button = document.createElement("button");
                button.className = "choice-btn";
                button.textContent = choice;
                button.addEventListener("click", () => handleChoice(index));
                choicesContainer.appendChild(button);
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∏–≥—Ä–æ–∫–∞
        function handleChoice(choiceIndex) {
            // –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞
            if (choiceIndex === 0) {
                playerTraits.courage += 2;
                playerTraits.compassion += 1;
            } else if (choiceIndex === 1) {
                playerTraits.wisdom += 1;
                coinsEl.textContent = parseInt(coinsEl.textContent) + 20;
            } else {
                playerTraits.courage -= 1;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            healthEl.textContent = Math.max(0, 100 - Math.floor(Math.random() * 10));
            energyEl.textContent = Math.max(0, parseInt(energyEl.textContent) - 15);
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
            setTimeout(generateInitialQuest, 1500);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Three.js
        function initThreeJS() {
            // –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87CEEB);
            scene.fog = new THREE.Fog(0x87CEEB, 20, 100);
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–µ—Ä—ã
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 10, 20);
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
            renderer = new THREE.WebGLRenderer({ 
                canvas: document.getElementById('gameCanvas'),
                antialias: true 
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            
            // –û—Ä–±–∏—Ç–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏)
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // –û—Å–≤–µ—â–µ–Ω–∏–µ
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(20, 30, 20);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 1024;
            directionalLight.shadow.mapSize.height = 1024;
            scene.add(directionalLight);
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∑–µ–º–ª–∏
            const groundGeometry = new THREE.PlaneGeometry(100, 100, 50, 50);
            const groundMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x3d8b40,
                wireframe: false
            });
            terrain = new THREE.Mesh(groundGeometry, groundMaterial);
            terrain.rotation.x = -Math.PI / 2;
            terrain.receiveShadow = true;
            scene.add(terrain);
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –≤–æ–¥—ã
            const waterGeometry = new THREE.PlaneGeometry(40, 40);
            const waterMaterial = new THREE.MeshStandardMaterial({
                color: 0x0077be,
                transparent: true,
                opacity: 0.7,
                metalness: 0.8,
                roughness: 0.1
            });
            const water = new THREE.Mesh(waterGeometry, waterMaterial);
            water.rotation.x = -Math.PI / 2;
            water.position.y = 0.1;
            water.position.x = -20;
            water.position.z = -20;
            scene.add(water);
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ä–µ–≤—å–µ–≤
            for (let i = 0; i < 30; i++) {
                addTree(
                    Math.random() * 80 - 40,
                    0,
                    Math.random() * 80 - 40
                );
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–Ω–µ–π
            for (let i = 0; i < 20; i++) {
                addRock(
                    Math.random() * 80 - 40,
                    0,
                    Math.random() * 80 - 40
                );
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–¥–∞–Ω–∏—è
            addBuilding(-30, 0, 30);
            
            // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏
            animate();
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', onWindowResize);
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞
        function addTree(x, y, z) {
            // –°—Ç–≤–æ–ª
            const trunkGeometry = new THREE.CylinderGeometry(0.4, 0.5, 3, 8);
            const trunkMaterial = new THREE.MeshStandardMaterial({ color: 0x8B4513 });
            const trunk = new THREE.Mesh(trunkGeometry, trunkMaterial);
            trunk.position.set(x, y + 1.5, z);
            trunk.castShadow = true;
            scene.add(trunk);
            
            // –ö—Ä–æ–Ω–∞
            const crownGeometry = new THREE.ConeGeometry(2, 5, 8);
            const crownMaterial = new THREE.MeshStandardMaterial({ color: 0x2E8B57 });
            const crown = new THREE.Mesh(crownGeometry, crownMaterial);
            crown.position.set(x, y + 5, z);
            crown.castShadow = true;
            scene.add(crown);
            
            objects.push(trunk, crown);
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–Ω—è
        function addRock(x, y, z) {
            const rockGeometry = new THREE.DodecahedronGeometry(1, 0);
            const rockMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x7a7a7a,
                roughness: 0.8
            });
            const rock = new THREE.Mesh(rockGeometry, rockMaterial);
            rock.position.set(x, y + 1, z);
            rock.castShadow = true;
            rock.rotation.y = Math.random() * Math.PI;
            scene.add(rock);
            objects.push(rock);
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–¥–∞–Ω–∏—è
        function addBuilding(x, y, z) {
            // –û—Å–Ω–æ–≤–∞–Ω–∏–µ
            const baseGeometry = new THREE.BoxGeometry(8, 4, 8);
            const baseMaterial = new THREE.MeshStandardMaterial({ color: 0xc0c0c0 });
            const base = new THREE.Mesh(baseGeometry, baseMaterial);
            base.position.set(x, y + 2, z);
            base.castShadow = true;
            base.receiveShadow = true;
            scene.add(base);
            
            // –ö—Ä—ã—à–∞
            const roofGeometry = new THREE.ConeGeometry(6, 4, 4);
            const roofMaterial = new THREE.MeshStandardMaterial({ color: 0x8B0000 });
            const roof = new THREE.Mesh(roofGeometry, roofMaterial);
            roof.position.set(x, y + 5, z);
            roof.rotation.y = Math.PI / 4;
            roof.castShadow = true;
            scene.add(roof);
            
            // –î–≤–µ—Ä—å
            const doorGeometry = new THREE.BoxGeometry(1.5, 2.5, 0.2);
            const doorMaterial = new THREE.MeshStandardMaterial({ color: 0x5d2906 });
            const door = new THREE.Mesh(doorGeometry, doorMaterial);
            door.position.set(x, y + 1, z + 4.1);
            scene.add(door);
            
            objects.push(base, roof, door);
        }
        
        // –ê–Ω–∏–º–∞—Ü–∏—è
        function animate() {
            requestAnimationFrame(animate);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–∞–º–µ—Ä—ã (–≤ —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –∑–¥–µ—Å—å –±—ã–ª–æ –±—ã –¥–≤–∏–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞)
            camera.position.x = 30 * Math.sin(Date.now() * 0.001);
            camera.position.z = 30 * Math.cos(Date.now() * 0.001);
            camera.lookAt(0, 0, 0);
            
            controls.update();
            renderer.render(scene, camera);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∏–Ω–∏-–∫–∞—Ä—Ç—ã
            updateMiniMap();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∏–Ω–∏-–∫–∞—Ä—Ç—ã
        function updateMiniMap() {
            const playerMarker = document.getElementById('playerMarker');
            const mapSize = 150;
            const worldSize = 100;
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –∑–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –±—ã —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–≥—Ä–æ–∫–∞
            const playerX = 50 * Math.sin(Date.now() * 0.002);
            const playerZ = 50 * Math.cos(Date.now() * 0.002);
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–∏—Ä–æ–≤—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–∏–Ω–∏-–∫–∞—Ä—Ç—ã
            const markerX = (playerX + worldSize/2) * (mapSize / worldSize);
            const markerY = (playerZ + worldSize/2) * (mapSize / worldSize);
            
            playerMarker.style.left = `${markerX}px`;
            playerMarker.style.top = `${markerY}px`;
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', initGame);
        
        // –ö–Ω–æ–ø–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
        document.getElementById('interactBtn').addEventListener('click', function() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –∑–¥–µ—Å—å –±—ã–ª–æ –±—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏
            questDescription.textContent = "–í—ã –æ—Å–º–æ—Ç—Ä–µ–ª–∏ –º–µ—Å—Ç–Ω–æ—Å—Ç—å. –ù–∞ —Å–µ–≤–µ—Ä–µ –≤—ã –∑–∞–º–µ—á–∞–µ—Ç–µ –¥—Ä–µ–≤–Ω–∏–µ —Ä—É–∏–Ω—ã, –Ω–∞ –∑–∞–ø–∞–¥–µ - —Ç–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ª–µ—Å.";
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
            const currentEnergy = parseInt(energyEl.textContent);
            energyEl.textContent = Math.max(0, currentEnergy - 10);
        });
        
        // –ö–Ω–æ–ø–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        document.getElementById('inventoryBtn').addEventListener('click', function() {
            questTitle.textContent = "–í–∞—à –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å";
            questDescription.textContent = "–ú–µ—á –Ω–æ–≤–∏—á–∫–∞, –ö–æ–∂–∞–Ω—ã–π –¥–æ—Å–ø–µ—Ö, 5 –ª–µ—á–µ–±–Ω—ã—Ö —Ç—Ä–∞–≤, –ö–∞—Ä—Ç–∞ —Ä–µ–≥–∏–æ–Ω–∞, –ó–∞–≥–∞–¥–æ—á–Ω—ã–π –∫–ª—é—á";
            choicesContainer.innerHTML = "";
        });
        
        // –ö–Ω–æ–ø–∫–∞ –∫–∞—Ä—Ç—ã
        document.getElementById('mapBtn').addEventListener('click', function() {
            questTitle.textContent = "–ö–∞—Ä—Ç–∞ —Ä–µ–≥–∏–æ–Ω–∞";
            questDescription.textContent = "–í—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –¥–æ–ª–∏–Ω–µ. –ù–∞ —Å–µ–≤–µ—Ä–µ - –∑–∞—Å–Ω–µ–∂–µ–Ω–Ω—ã–µ –≥–æ—Ä—ã, –Ω–∞ —é–≥–µ - –±–µ—Å–∫—Ä–∞–π–Ω—è—è –ø—É—Å—Ç—ã–Ω—è, –Ω–∞ –≤–æ—Å—Ç–æ–∫–µ - –¥—Ä–µ–≤–Ω–∏–π –ª–µ—Å, –Ω–∞ –∑–∞–ø–∞–¥–µ - –±–æ–ª–æ—Ç–∞.";
            
            // –û—á–∏—Å—Ç–∫–∞ –≤—ã–±–æ—Ä–∞
            choicesContainer.innerHTML = "";
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            const directions = ["–°–µ–≤–µ—Ä: –ì–æ—Ä—ã", "–Æ–≥: –ü—É—Å—Ç—ã–Ω—è", "–í–æ—Å—Ç–æ–∫: –õ–µ—Å", "–ó–∞–ø–∞–¥: –ë–æ–ª–æ—Ç–∞"];
            directions.forEach((dir, index) => {
                const button = document.createElement("button");
                button.className = "choice-btn";
                button.textContent = dir;
                button.addEventListener("click", () => {
                    questDescription.textContent = `–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏—Å—å –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏: ${dir.split(':')[1].trim()}`;
                    energyEl.textContent = Math.max(0, parseInt(energyEl.textContent) - 20);
                });
                choicesContainer.appendChild(button);
            });
        });
    </script>
</body>
</html>
